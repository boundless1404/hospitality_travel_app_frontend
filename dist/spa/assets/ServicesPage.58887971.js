import{Q as P}from"./QItemLabel.9ddb68b1.js";import{Q as ie}from"./use-dark.f400b985.js";import{Q as x,a as y}from"./QCard.bc89b753.js";import{Q as ue}from"./QPage.2dc96178.js";import{ax as me,h as fe,l as ve,d as J,r as d,c as B,o as X,n as l,v as Q,x as o,A as r,f as e,D as R,aU as v,p as h,an as U,B as oe,Q as E,E as ce,F as N,y as z,G as pe,H as he,w as _e,ao as ne,q as ge,am as we,ai as Se,ay as T,C as H,aR as ye}from"./index.3c48b6f7.js";import{B as Oe,V as be}from"./base.view-model.5e1efaea.js";import{S as re}from"./urlPaths.enum.82ba9a55.js";import{t as ke}from"./utils.6837a8f1.js";import{a as G}from"./QSelect.7c826cfb.js";import{C as K}from"./ClosePopup.f1c5c72d.js";import{Q as qe,B as Ce}from"./BookingsComponent.4bbc2af4.js";import{_ as de}from"./plugin-vue_export-helper.21dcd24c.js";import"./axios.4c6579cc.js";import"./use-key-composition.d4c28df8.js";import"./focus-manager.02955f48.js";import"./use-model-toggle.e512d394.js";import"./QMenu.f664353c.js";import"./selection.87736456.js";import"./use-form.63261807.js";import"./QTooltip.9c7d8d44.js";import"./QExpansionItem.c04b3fa0.js";import"./bookings.view-model.3c432e2e.js";import"./QInput.04198cfd.js";import"./use-cache.b0833c75.js";import"./QForm.e33f984a.js";class $e extends Oe{message;submessage;servicesWithProviders;selectedService}class Pe extends be{authStore=me();async getServices(){this.model.servicesWithProviders=await this.requestApi(re.GET_SERVICES);const i=this.authStore.getField("userData");this.model.message=ke(`Hi ${(i==null?void 0:i.firstName)||(i==null?void 0:i.lastName)||""},`),this.model.submessage="Here are some services for you to pick from."}async getServiceOffers(i){const s=this.getServiceById(i);if(!s){alert("A fatal error occurred. Kindly refresh the page or log out and log back in.");return}let b=s.offers;b||(b=await this.requestApi(`${re.GET_OFFERS}?serviceId=${i}`),s.offers=b),this.model.selectedService=s}getServiceById(i){return this.model.servicesWithProviders.find(s=>s.id===i)}}const Be=fe("div",{class:"q-space"});var ae=ve({name:"QSpace",setup(){return()=>Be}});const xe=O=>(pe("data-v-26d835b2"),O=O(),he(),O),Qe={class:"row justify-center items-center q-mb-md"},Ve={class:"section q-mb-md"},Me={class:"row q-col-gutter-sm more-margin-left"},Ie={key:0,class:"feature-item row items-center"},De={key:1,class:"feature-item row items-center"},Fe={class:"price-section"},We={class:"row items-center justify-between"},Ae=xe(()=>r("div",{class:"text-h6"},"All Features",-1)),Ee={class:"row q-col-gutter-md"},Ue={class:"feature-item row items-center"},j=12,Ne=J({__name:"ServiceOfferDetail",props:{service:{},offer:{}},emits:["update:show-modal"],setup(O,{emit:i}){var $,I,D,F,Y,Z,ee,se;const s=O,b=i,u=d((I=($=s.offer)==null?void 0:$.priceOptions)==null?void 0:I[0]),k=d(!1),C=d((D=s.offer)==null?void 0:D.id),g=d((F=u.value)==null?void 0:F.id),_=d(((Z=(Y=s.service)==null?void 0:Y.provider)==null?void 0:Z.name)||""),V=d(((se=(ee=s.offer)==null?void 0:ee.priceOptions)==null?void 0:se[0].price)||0),f=d(!1),c=d("autoBooking"),t=B(()=>{var a,m;return(m=(a=s.offer)==null?void 0:a.priceOptions)==null?void 0:m.map(W=>({label:W.price,value:W.id}))}),n=B(()=>{var a,m;return(m=(a=s.offer)==null?void 0:a.features)==null?void 0:m.slice(0,j)}),q=B(()=>{var a,m;return(((m=(a=s.offer)==null?void 0:a.features)==null?void 0:m.length)||0)>j}),M=B(()=>{var a,m;return(((m=(a=s.offer)==null?void 0:a.features)==null?void 0:m.length)||0)-j}),S=()=>{f.value=!0};function L(a){k.value=a,b("update:show-modal",a)}return X(()=>{switch(console.log("this is the cSer name: --> ",c.value),console.log("this is the selected offer: ",s.offer),!0){case s.service.name.toLocaleLowerCase().indexOf("auto")!==-1:c.value="autoBooking";break;case s.service.name.toLocaleLowerCase().indexOf("tour")!==-1:c.value="tourBooking";break;case s.service.name.toLocaleLowerCase().indexOf("visa")!==-1:c.value="visaBooking";break}console.log("this is the component name: --> ",c.value,s.service.name)}),(a,m)=>(l(),Q(x,{class:"service-offer-detail q-pa-md"},{default:o(()=>{var W;return[r("div",Qe,[e(P,{class:"q-ma-none text-h5 secondarytwo"},{default:o(()=>{var p,w;return[R(v((p=a.service)==null?void 0:p.name)+" - "+v((w=a.offer)==null?void 0:w.name),1)]}),_:1})]),r("div",Ve,[e(P,{class:"text-subtitle1 q-mb-sm secondarytwo"},{default:o(()=>[R("Description")]),_:1}),r("p",null,v((W=a.offer)==null?void 0:W.description),1)]),e(y,{class:"section"},{default:o(()=>[e(P,{class:"text-subtitle1 q-mb-sm secondarytwo",label:"Features"}),r("div",Me,[(l(!0),h(N,null,U(n.value,(p,w)=>{var A;return l(),h("div",{key:w,class:"col-12 col-sm-6 col-md-3"},[w<(((A=n.value)==null?void 0:A.length)||0)-1?(l(),h("div",Ie,[e(oe,{name:p.icon,size:"sm",color:"primary",class:"q-mr-xs"},null,8,["name"]),r("span",null,v(p.name),1)])):(l(),h("div",De,[q.value?(l(),Q(E,{key:0,flat:"",color:"primary",onClick:S},{default:o(()=>[R(" + "+v(M.value+1)+" more ",1)]),_:1})):ce("",!0)]))])}),128))])]),_:1}),e(y,{class:"section"},{default:o(()=>[e(P,{class:"text-subtitle1 q-mb-sm secondarytwo",label:"Price"}),r("div",Fe,[r("div",We,[e(P,{class:"text-subtitle1 q-mr-sm secondarytwo"},{default:o(()=>{var p,w,A,te;return[R(v("\u20A6")+v(((p=a.offer)==null?void 0:p.price)||((te=(A=(w=a.offer)==null?void 0:w.priceOptions)==null?void 0:A[0])==null?void 0:te.price)),1)]}),_:1}),e(E,{flat:"",color:"black",class:"secondarytwo",rounded:"",outlined:"",onClick:m[0]||(m[0]=p=>k.value=!0),label:"Select"})])])]),_:1}),e(G,{modelValue:f.value,"onUpdate:modelValue":m[1]||(m[1]=p=>f.value=p)},{default:o(()=>[e(x,{style:{"min-width":"350px"}},{default:o(()=>[e(y,null,{default:o(()=>[Ae]),_:1}),e(y,{class:"q-pt-none"},{default:o(()=>{var p;return[r("div",Ee,[(l(!0),h(N,null,U((p=a.offer)==null?void 0:p.features,w=>(l(),h("div",{key:w.id,class:"col-12 col-sm-6"},[r("div",Ue,[e(oe,{name:w.icon,size:"sm",class:"q-mr-sm"},null,8,["name"]),r("span",null,v(w.name),1)])]))),128))])]}),_:1}),e(qe,{align:"right"},{default:o(()=>[z(e(E,{flat:"",label:"Close",color:"primary"},null,512),[[K]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ce,{"show-modal":k.value,"current-booking-component-name":c.value,offerBookingComponentProps:{serviceOfferId:C.value,serviceOfferPriceOptionId:g.value,currentSelectedPriceOption:u.value,serviceOfferProviderName:_.value,priceSelectOptions:t.value,serviceOfferPrice:V.value},"onUpdate:showModal":L},null,8,["show-modal","current-booking-component-name","offerBookingComponentProps"])]}),_:1}))}});var le=de(Ne,[["__scopeId","data-v-26d835b2"]]);const Le={class:"text-h6"},Re={class:"row q-col-gutter-md"},ze={class:"row q-col-gutter-md"},Te={class:"price-tag"},He={class:"offer-image-container"},je={class:"offer-name"},Ge={key:0,class:"col-12 q-mt-md"},Ke={key:0},Je={class:"text-h6"},Xe=J({__name:"ServiceDialogue",props:{isOpen:{type:Boolean},selectedService:{}},emits:["update:isOpen"],setup(O,{emit:i}){const s=O,b=i,u=d(),k=d(s.selectedService.offers||[]),C=d(0),g=B(()=>{const t=[];for(let n=0;n<k.value.length;n+=4)t.push(k.value.slice(n,n+4));return t}),_=d(!1),V=t=>{var n;u.value=((n=u.value)==null?void 0:n.id)===t.id?{}:t,u.value.id&&(_.value=!0)};function f(t){b("update:isOpen",t),c()}function c(){u.value=void 0}return _e(()=>s.selectedService,t=>{k.value=t.offers||[]}),X(()=>{console.log("Modal is open: ",s.isOpen),console.log("The selected service is: ",s.selectedService),console.log("ServiceDialogue mounted",s.selectedService.offers)}),(t,n)=>(l(),Q(G,{"model-value":t.isOpen,"onUpdate:modelValue":f,persistent:"",class:"service-dialogue"},{default:o(()=>[e(x,{class:"dialogue-card"},{default:o(()=>[e(y,{class:"row items-center q-pb-none"},{default:o(()=>[r("div",Le,v(t.selectedService.name),1),e(ae),z(e(E,{icon:"close",flat:"",round:"",dense:""},null,512),[[K]])]),_:1}),e(y,{class:"service-offers q-pa-md"},{default:o(()=>[r("div",Re,[(l(!0),h(N,null,U(g.value,(q,M)=>(l(),h("div",{key:M,class:"col-12"},[r("div",ze,[(l(!0),h(N,null,U(q,S=>{var L;return l(),h("div",{key:S.id,class:"col-12 col-sm-6 col-md-3"},[e(x,{class:ne(["offer-tile cursor-pointer",{selected:((L=u.value)==null?void 0:L.id)===S.id}]),onClick:$=>{V(S),C.value=M}},{default:o(()=>{var $,I;return[e(y,null,{default:o(()=>{var D,F;return[r("div",Te,"\u20A6"+v(S.price||((F=(D=S.priceOptions)==null?void 0:D[0])==null?void 0:F.price)),1)]}),_:2},1024),r("div",He,[e(ie,{src:((I=($=S.files)==null?void 0:$[0])==null?void 0:I.url)||"https://pixabay.com/vectors/car-porsche-sports-car-luxury-1300629","spinner-color":"primary",class:"offer-image"},null,8,["src"])]),e(y,null,{default:o(()=>[r("div",je,v(S.name),1)]),_:2},1024)]}),_:2},1032,["onClick","class"])])}),128)),u.value&&M===C.value?(l(),h("div",Ge,[t.$q.screen.gt.md?(l(),h("div",Ke,[e(le,{service:t.selectedService,offer:u.value,"onUpdate:showModal":c},null,8,["service","offer"])])):(l(),Q(G,{key:1,modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=S=>_.value=S)},{default:o(()=>[e(x,{class:"detail-modal"},{default:o(()=>[e(y,{class:"row items-center"},{default:o(()=>[r("div",Je,v(u.value.name),1),e(ae),z(e(E,{icon:"close",flat:"",round:"",dense:""},null,512),[[K]])]),_:1}),e(y,null,{default:o(()=>[e(le,{service:t.selectedService,offer:u.value,"onUpdate:showModal":c},null,8,["service","offer"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))])):ce("",!0)])]))),128))])]),_:1})]),_:1})]),_:1},8,["model-value"]))}});var Ye=de(Xe,[["__scopeId","data-v-6e70d8d2"]]);const Ze={class:"q-ml-xl q-pl-sm"},es={class:ne(["row","justify-evenly q-gutter-sm"])},ss={class:"suite-service-description"},$s=J({__name:"ServicesPage",setup(O){const i=ge(),s=we();d("outline");const b=d(0);d("SuitePanel"),d(!0);const u=d(!1),k=d({}),C=B(()=>s.screen.lt.lg?"32vw":"20vw"),g=new Pe(Se(new $e)),_=g.model;async function V(f,c){var t,n,q;c.toLowerCase().indexOf("apartment")>-1?i.push(`${i.currentRoute.value.path}/${f}/suites`):(await g.getServiceOffers(f),k.value=_.selectedService,u.value=!0,await((t=g.stores.serviceWithOffer)==null?void 0:t.insertServiceOfferIntoService(f,_.selectedService.offers)),console.log("this is the service offers",(n=g.stores.serviceWithOffer)==null?void 0:n.getItem(f)),console.log("this is the service state",(q=g.stores.serviceWithOffer)==null?void 0:q.$state))}return X(async()=>{var f,c;if(await g.getServices(),await((f=g.stores.serviceWithOffer)==null?void 0:f.initializeStore()),console.log("from mounted ",_.servicesWithProviders),(c=g.stores.serviceWithOffer)==null||c.insertServices(_.servicesWithProviders),b.value<1){b.value++;return}}),(f,c)=>(l(),Q(ue,null,{default:o(()=>[r("div",null,[r("div",null,[r("h4",null,v(T(_).message),1)]),r("p",Ze,v(T(_).submessage),1),r("div",es,[(l(!0),h(N,null,U(T(_).servicesWithProviders,(t,n)=>(l(),h("div",{key:n,class:"col-lg-3 col-md-4 col-sm-12",style:H({width:C.value})},[z((l(),Q(x,{class:"q-pb-none rounded-border cursor-pointer",style:{"border-radius":"2rem"},bordered:""},{default:o(()=>[e(y,{class:"q-pa-none q-ma-none",style:{position:"relative"},onClick:q=>V(t.id,t.name)},{default:o(()=>{var q;return[e(P,{class:"absolute-top-left q-px-xl q-ml-lg q-mt-lg text-h6 text-white bg-accent shadow-1",style:{"z-index":"999","max-width":"80%"},label:t.name},null,8,["label"]),e(ie,{src:(q=t.files)==null?void 0:q[0].url,style:H({width:C.value,height:C.value,borderRadius:"2rem"})},null,8,["src","style"])]}),_:2},1032,["onClick"])]),_:2},1024)),[[ye]]),r("div",{class:"q-mt-md",style:H({color:`${f.$getColor("blue-grey-10")}`})},[r("p",ss,v(t.description),1)],4)],4))),128))])]),e(Ye,{"is-open":u.value,"selected-service":k.value,"onUpdate:isOpen":c[0]||(c[0]=t=>u.value=t)},null,8,["is-open","selected-service"])]),_:1}))}});export{$s as default};
