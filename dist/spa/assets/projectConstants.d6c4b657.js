import{B as p,r as f,V as l}from"./base.view-model.5e1efaea.js";import{api as d}from"./axios.4c6579cc.js";import{A as r}from"./urlPaths.enum.82ba9a55.js";import{ax as g,aI as w}from"./index.3c48b6f7.js";class q extends p{code}async function B(s){const e=await d.post(r.SIGNUP,s,{headers:{Authorization:void 0}});if([200,201].includes(e.status))return e.data;throw new Error("Signin failed",{cause:e.data})}async function y(s,e){return f(r.VERIFY,"post",{body:{token:s,email:e,tokenPurpose:"sign_up"}})}class T extends l{authStore=g();async submitToken(e,{onSuccess:t,onError:a}){try{await this.invokevalidation(a),delete this.model.errors;const i=await y(this.model.code,e),o=await this.requestApi(r.USER,"get",{headers:{Authorization:`Bearer ${i.token}`}}),n={token:i.token,...o};await this.authStore.handleAuthToken(n),t==null||t()}catch(i){a==null||a(i.message);return}}}function u({type:s="positive",message:e}={}){w.create({message:e||(s==="negative"?"Process failed":"Process succcessful!"),type:s,timeout:s==="positive"?300:5e3})}function R(s){if(s.value){u({type:"warning",message:"Please, wait for the current process to complete."});return}}function S(s,e,t){s.value=!0,e.show({message:t||"Processing!"})}async function U({process:s,onError:e,loader:t,useNotifer:a=!0,notifierType:i="positive",notifierMessage:o,loaderMessage:n="Please, wait!",showErrorNotifier:h=!0}){t&&t.show({message:n});try{await s(),a&&u({type:i,...o?{message:o}:{}})}catch(m){const c=m;e==null||e(),h&&u({type:"negative",...c.message?{message:c.message}:{}})}finally{t!=null&&t.isActive&&t.hide()}}const V=1e4;export{q as S,T,R as a,S as b,U as c,V as l,B as r,u};
